{% extends 'layout_main.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/search.css') }}" type="text/css">
{% endblock %}

{% block body %}
    <div class="container-non-responsive search-page-container">
            <!--Left Navbar Section -->
            <div class="row">
                <div class="col-xs-3 siderbar">
                    {% include 'Widget/bestPro.html.twig' %}
                    {% include 'Widget/discountPro.html.twig' %}
                </div>

                <div class="col-xs-9 page-right">
                <div class="page-breadcrumb">
                 <ol>
                    <li><a href="{{ path('homepage')}}"><i class="fa fa-home"></i></a></li>
                     {% if data.path is defined %}      
                         {% for category in data.path %}
                              <li>&nbsp;>&nbsp;<a href="{{ path('category', { id : category.id }) }}">{{ category.name }} </a></li>
                         {% endfor %}
                         <li>(共{{ data.total_no }}件商品)</li>
                            {% else %}
                            <li> &nbsp;>&nbsp;全部分类 (共{{ data.total_no }}件商品) </li>
                            {% endif %}
                    
                         </ol>
                        
                        {% if data.children|length > 0 %}
                        <div class="toolbar">
                        <div>可选分类</div>
                            {% for category in data.children %}
                            <a class="search-keys" href="{{ path('category', {id : category.id}) }}">{{ category.name }}</a>
                            {% endfor %}
                        </div>
                        {% endif %}
                       
                    </div>

                    <div class="page-title">
                    </div>
                    {#{{dump(data)}}#}
                    <div class="page-content">
                        <!--toolbar-->  
                        <div class="toolbar">
                            <div class="pull-left">
                                <a href="{{ path('category', {
                                    id : id,
                                    sort : 1,
                                    item_no : item_no
                                    }) }}">
                                    <div class="select-box-order {% if sort == 1 %} active {% endif %}" id="select-box1" onClick="changeselectbox(1)">
                                        <i>默认排序</i>  
                                    </div>
                                </a>
                                {% if sort == 2 %}
                                    <a href="{{ path('category', {
                                    id : id,
                                    page : 1,
                                    item_no : item_no,
                                    sort : 3 }) }}">
                                    <div class="select-box-order active" id="select-box2" onClick="changeselectbox(2)">
                                        <i>价格</i>
                                        <i class="fa fa-long-arrow-up"></i>
                                    </div>
                                </a>
                                {% else %}
                                    <a href="{{ path('category', {
                                    id : id,
                                    page : 1,
                                    item_no : item_no,
                                    sort : 2 }) }}">
                                    <div class="select-box-order {% if sort == 3 %} active {% endif %}" id="select-box2" onClick="changeselectbox(2)">
                                        <i>价格</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                {% endif %}

                                <a href="{{ path('category', {
                                    id : id,
                                    item_no: item_no,
                                    sort : 4 }) }}">
                                    <div class="select-box-order {% if sort == 4 %} active {% endif %}" id="select-box3" onClick="changeselectbox(3)">
                                        <i>销量</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                </a>
                                <a href="{{ path('category', {
                                    id : id,
                                    item_no: item_no,
                                    sort : 5}) }}">
                                    <div class="select-box-order {% if sort == 5 %} active {% endif %}" id="select-box4" onClick="changeselectbox(4)">
                                        <i>发布时间</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                </a>
                                <a href="{{ path('category', {
                                    id : id,
                                    item_no: item_no,
                                    sort : 6}) }}">
                                    <div class="select-box-order {% if sort == 6 %} active {% endif %}" id="select-box5" onClick="changeselectbox(5)">
                                        <i>浏览次数</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                </a>
                            </div>

                            <div class="pull-right">
                                <label>每页显示：</label>
                                <span class="select-box-num">
                                    <a href="{{ path('category', {
                                        id : id,
                                        sort : sort,
                                        item_no: 36
                                    }) }}" {% if item_no == 36 %} class="active" {% endif %}>36</a>
                                    <a href="{{ path('category', {
                                        id : id,
                                        sort : sort,
                                        item_no: 24
                                    }) }}" {% if item_no == 24 %} class="active" {% endif %}>24</a>
                                    <a href="{{ path('category', {
                                        id : id,
                                        sort : sort,
                                        item_no: 18
                                    }) }}" {% if item_no == 18 %} class="active" {% endif %}>18</a>
                                </span>
                            </div>

                        </div>
                        <!--//toolbar-->  
                        <!--search products--> 
                        <div class="hotdeal clearfix">
                        {% for i in 1..(data.row_no) %}
                            <div class="row">
                                {% for product in data.products|slice(3*(i - 1), 3) %}
                                    <div class="col-xs-4">
                                        <a href="{{ path('product', {id : product.id}) }}">
                                            <img class="lazy" src="{{ asset(random(['img/aptami.jpg', 'img/honey.jpg', 'img/honey2.jpg' ,'img/blackmores.jpg', 'img/artemis.jpg', 'img/manukablendhoney.jpg', 'img/milkchews.jpg', 'img/royalnectar.jpg', 'img/swisse.jpg'])) }}" data-original="{{ asset(random(['img/aptami.jpg', 'img/honey.jpg', 'img/honey2.jpg' ,'img/blackmores.jpg', 'img/artemis.jpg', 'img/manukablendhoney.jpg', 'img/milkchews.jpg', 'img/royalnectar.jpg', 'img/swisse.jpg'])) }}" alt="">
                                            <div class="pro-text">
                                            <div class="pro-title">{{ product.name }}<br></div>
                                            <div class="price">${{ product.priceDiscounted }}</div>
                                            <del>${{ product.price }}</del>
                                             <br>
                                            <div class="sold-no">售出:&nbsp;{{ product.soldNo }}</div>
                                             <div class="sold-no">浏览数：{{ product.click }}</div>
                                             </div>
                                        </a>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endfor %}

                        </div> 
                        <div class="toolbar toolbar-bottom">
                            <div class="pull-right">
                                <label>页面：</label>
                                <span class="select-box-num">                                
                                    <a href="{{ path('category', {
                                        id : id,
                                        page : page + 1,
                                        sort : sort,
                                        item_no: item_no
                                    }) }}" {% if page == data.total_page %} class="hide" {% endif %} class="i-next" href="#" title="下一个"><i class="fa fa-caret-right"></i></a>
                                    {% for i in data.total_page..1 %}
                                        <a href="{{ path('category', {
                                            id : id,
                                            page : i,
                                            sort : sort,
                                            item_no: item_no
                                        }) }}" {% if i == page %} class="active" {% endif %}> {{ i }}</a>
                                    {% endfor %}
                                    <a href="{{ path('category', {
                                        id : id,
                                        page : page - 1,
                                        sort : sort,
                                        item_no: item_no
                                    }) }}" {% if page - 1 == 0 %} class="hide" {% endif %} class="i-next" href="#" title="上一个"><i class="fa fa-caret-left"></i></a>
                                </span>
                            </div>
                        </div> 
                    </div>
                </div>  
            </div>
        </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/search.js') }}"></script>
{% endblock %}