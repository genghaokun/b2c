{% extends 'layout_main.html.twig' %}

{% block title %}搜索{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/search.css') }}" type="text/css">
{% endblock %}


{% block body %}
    <div class="container-non-responsive search-page-container">
            <!--Left Navbar Section -->
            <div class="row">
                <div class="col-xs-3 siderbar">
                    <div id="siderbar">
                    	{{ render(controller('AppBundle:Widget/Menu:index')) }}
                    </div>
                    {% include 'Widget/bestPro.html.twig' %}
                    {% include 'Widget/discountPro.html.twig' %}
                </div>

                <div class="col-xs-9 page-right">
                <div class="page-breadcrumb">
                 <ol>
                    <li><a href="{{ path('homepage')}}"><i class="fa fa-home"></i></a></li>
                    <li>&nbsp;>&nbsp;搜索结果 (共{{ data.total_no }}件商品)</li>
                </ol>
                </div>
                
                    <div class="page-title">
                        
                    </div>
                    <div class="page-content">
                        <!--toolbar-->  
                        <div class="toolbar">
                            <div class="pull-left">

                                <a href="{{ path('search', {
                                    keys : app.request.get('keys'),
                                    sort : 1,
                                    item_no: app.request.get('item_no')}) }}">
                                    <div class="select-box-order {% if app.request.get('sort') == 1  or not app.request.get('sort') %} active {% endif %}" id="select-box1" onClick="changeselectbox(1)">
                                        <i>默认排序</i>  
                                    </div>
                                </a>
                                {% if app.request.get('sort') == 2 %}
                                    <a href="{{ path('search', {
                                    keys : app.request.get('keys'),
                                    item_no: app.request.get('item_no'),
                                    sort : 3 }) }}">
                                    <div class="select-box-order active" id="select-box2" onClick="changeselectbox(2)">
                                        <i>价格</i>
                                        <i class="fa fa-long-arrow-up"></i>
                                    </div>
                                </a>
                                {% else %}
                                    <a href="{{ path('search', {
                                    keys : app.request.get('keys'),
                                    item_no: app.request.get('item_no'),
                                    sort : 2 }) }}">
                                    <div class="select-box-order {% if app.request.get('sort') == 3 %} active {% endif %}" id="select-box2" onClick="changeselectbox(2)">
                                        <i>价格</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                {% endif %}

                                <a href="{{ path('search', {
                                    keys : app.request.get('keys'),
                                    item_no: app.request.get('item_no'),
                                    sort : 4 }) }}">
                                    <div class="select-box-order {% if app.request.get('sort') == 4 %} active {% endif %}" id="select-box3" onClick="changeselectbox(3)">
                                        <i>销量</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                </a>
                                <a href="{{ path('search', {
                                    keys : app.request.get('keys'),
                                    item_no: app.request.get('item_no'),
                                    sort : 5}) }}">
                                    <div class="select-box-order {% if app.request.get('sort') == 5 %} active {% endif %}" id="select-box4" onClick="changeselectbox(4)">
                                        <i>发布时间</i>
                                        <i class="fa fa-long-arrow-down"></i>
                                    </div>
                                </a>

                            </div>

                            <div class="pull-right">
                                <label>每页显示：</label>
                                <span class="select-box-num">
                                    <a href="{{ path('search', {
                                        keys : app.request.get('keys'),
                                        sort : app.request.get('sort'),
                                        item_no: 36
                                    }) }}" {% if app.request.get('item_no') == 36 %} class="active" {% endif %}>36</a>
                                    <a href="{{ path('search', {
                                        keys : app.request.get('keys'),
                                        sort : app.request.get('sort'),
                                        item_no: 24
                                    }) }}" {% if app.request.get('item_no') == 24 %} class="active" {% endif %}>24</a>
                                    <a href="{{ path('search', {
                                        keys : app.request.get('keys'),
                                        sort : app.request.get('sort'),
                                        item_no: 18
                                    }) }}" {% if app.request.get('item_no') == 18 or not app.request.get('item_no') %} class="active" {% endif %}>18</a>

                                </span>
                            </div>

                        </div>
                        <!--//toolbar-->  
                        <!--search products--> 
                        <div class="hotdeal clearfix">

                        {# {{ dump(data) }} #}
                        {% for i in 1..(data.row_no) %}
                            <div class="row">
                                {% for product in data.products|slice(3*(i - 1), 3) %}
                                    <div class="col-xs-4">
                                        <a href="{{ path('product', {id : product.id}) }}">
                                            <img class="lazy" src="{{ asset(random(['img/aptami.jpg', 'img/honey.jpg', 'img/honey2.jpg' ,'img/blackmores.jpg', 'img/artemis.jpg', 'img/manukablendhoney.jpg', 'img/milkchews.jpg', 'img/royalnectar.jpg', 'img/swisse.jpg'])) }}" data-original="{{ asset(random(['img/aptami.jpg', 'img/honey.jpg', 'img/honey2.jpg' ,'img/blackmores.jpg', 'img/artemis.jpg', 'img/manukablendhoney.jpg', 'img/milkchews.jpg', 'img/royalnectar.jpg', 'img/swisse.jpg'])) }}" alt="">
                                            <span class="pro-text"><span class="pro-title">{{ product.name }}<br></span><span class="price">${{ product.priceDiscounted }}</span><del>${{ product.price }}</del><br><span class="sold-no">售出：{{ product.soldNo }}</span></span>
                                        </a>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endfor %}

                        </div> 

                        <div class="toolbar toolbar-bottom">
                            <div class="pull-right">
                                <label>页面：</label>
                                <span class="select-box-num">

                                    <a href="{{ path('search', {
                                        keys : app.request.get('keys'),
                                        page : (app.request.get('page')) ? app.request.get('page')+1 : 2,
                                        sort : app.request.get('sort'),
                                        item_no: app.request.get('item_no')
                                    }) }}" class="i-next" href="#" title="下一个"><i class="fa fa-caret-right"></i></a>
                                    {% for i in data.total_page..1 %}
                                        <a href="{{ path('search', {
                                            keys : app.request.get('keys'),
                                            page : i,
                                            sort : app.request.get('sort'),
                                            item_no: app.request.get('item_no')
                                        }) }}" {% if not app.request.get('page') and i == 1 %} class="active" {% elseif i == app.request.get('page') %} class="active" {% endif %}> {{ i }}</a>
                                    {% endfor %}
                                </span>
                            </div>
                        </div> 
                    </div>
                </div>  
            </div> <!--//search products-->     

        </div>

        </div><!-- /container-non-responsive -->

{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/search.js') }}"></script>
{% endblock %}
